% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_zip_package.R
\name{generate_zip_package}
\alias{generate_zip_package}
\title{Generate ZIP Package from Quarto Document}
\usage{
generate_zip_package(
  qmd_path,
  output_dir = NULL,
  quiet = FALSE,
  overwrite = TRUE
)
}
\arguments{
\item{qmd_path}{Character. Path to the Quarto (.qmd) file to render and package.}

\item{output_dir}{Character or NULL. Directory where the rendered output and ZIP file
will be created. If NULL (default), uses the same directory as the .qmd file.}

\item{quiet}{Logical. If TRUE, suppresses rendering and zip creation messages.
Default is FALSE.}

\item{overwrite}{Logical. If TRUE, overwrites existing ZIP file with the same name.
If FALSE and ZIP file exists, throws an error. Default is TRUE.}
}
\value{
Character (invisibly). The absolute path to the created ZIP file.
}
\description{
Renders a Quarto (.qmd) document to HTML and packages it into a ZIP file suitable
for upload as a web package to Skilljar. The rendered content is placed in a
staging directory and then zipped.
}
\details{
This function performs the following steps:
\enumerate{
\item Validates that the input is a .qmd file and that it exists
\item Renders the Quarto document to HTML using \code{quarto::quarto_render()}
\item Outputs the rendered HTML as "index.html" in a staging directory
named "_\if{html}{\out{<filename>}}" (e.g., "_lesson1" for "lesson1.qmd")
\item Creates a ZIP file containing the rendered output directory
\item Cleans up the staging directory after successful ZIP creation or rendering failure
\item Returns the absolute path to the ZIP file
}

The function uses \code{withr::with_dir()} to safely manage working directory
changes during ZIP creation (when calling \code{utils::zip()}), ensuring the
working directory is always restored even if errors occur.

By default, both the staging directory and the ZIP file are created
in the same directory as the source .qmd file. This can be changed using the
\code{output_dir} parameter.

Cleanup behavior: The staging directory is automatically cleaned up when ZIP
creation succeeds or when rendering fails. However, if rendering succeeds but
ZIP creation fails, the staging directory is preserved for debugging purposes.

The output directory structure ensures that when the ZIP is extracted,
"index.html" is at the root level, which is required by most web package formats.

The generated ZIP file can be manually uploaded to a web server or cloud storage,
and the resulting URL can be used to create a Skilljar web package lesson.
For guidance on uploading to a hosting service and configuring Skilljar,
see the package README (\code{README.md}).
}
\section{Dependencies}{

This function requires the \code{quarto} R package and the Quarto CLI to be installed.
}

\examples{
\dontrun{
# Render and package a Quarto document (output in same directory as .qmd)
zip_path <- generate_zip_package("lessons/lesson1.qmd")
# Returns: "/path/to/lessons/lesson1.zip"

# Specify a different output directory
zip_path <- generate_zip_package("lessons/lesson1.qmd", output_dir = "output")
# Returns: "output/lesson1.zip"

# Quiet mode (suppress messages)
zip_path <- generate_zip_package("lesson1.qmd", quiet = TRUE)

# Don't overwrite existing ZIP files
zip_path <- generate_zip_package("lesson1.qmd", overwrite = FALSE)
}

}
